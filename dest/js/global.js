/*! poll.js 10-07-2014 */
function populateTable(){var a="";$.getJSON("/users/userlist",function(b){userListData=b,$.each(b,function(){a+="<tr>",a+='<td><a href="#" class="linkshowuser" rel="'+this.username+'" title="Show Details">'+this.username+"</td>",a+="<td>"+this.email+"</td>",a+='<td><a href="#" class="linkdeleteuser" rel="'+this._id+'">delete</a></td>',a+="</tr>"}),$("#userList table tbody").html(a)})}function showUserInfo(a){a.preventDefault();var b=$(this).attr("rel"),c=userListData.map(function(a){return a.username}).indexOf(b),d=userListData[c];$("#userInfoName").text(d.fullname),$("#userInfoAge").text(d.age),$("#userInfoGender").text(d.gender),$("#userInfoLocation").text(d.location)}function addUser(a){a.preventDefault();var b=0;if($("#addUser input").each(function(){""===$(this).val()&&b++}),0!==b)return alert("Please fill in all fields."),!1;var c={username:$("#addUser fieldset input#inputUserName").val(),email:$("#addUser fieldset input#inputUserEmail").val(),fullname:$("#addUser fieldset input#inputUserFullname").val(),age:$("#addUser fieldset input#inputUserAge").val(),location:$("#addUser fieldset input#inputUserLocation").val(),gender:$("#addUser fieldset input#inputUserGender").val()};$.ajax({type:"POST",data:c,url:"/users/adduser",dataType:"JSON"}).done(function(a){""===a.msg?($("#addUser fieldset input").val(""),populateTable()):alert("Error: "+a.msg)})}function deleteUser(a){a.preventDefault();var b=confirm("Are you sure you want to delete this user?");return b!==!0?!1:void $.ajax({type:"DELETE",url:"/users/deleteuser/"+$(this).attr("rel")}).done(function(a){""===a.msg||alert("Error: "+a.msg),populateTable()})}var userListData=[];$(document).ready(function(){populateTable(),$("#userList table tbody").on("click","td a.linkshowuser",showUserInfo),$("#btnAddUser").on("click",addUser),$("#userList table tbody").on("click","td a.linkdeleteuser",deleteUser)});