/*! poll.js 10-07-2014 */
function populateTable(){var tableContent="";$.getJSON("/users/userlist",function(data){userListData=data,$.each(data,function(){tableContent+="<tr>",tableContent+='<td><a href="#" class="linkshowuser" rel="'+this.username+'" title="Show Details">'+this.username+"</td>",tableContent+="<td>"+this.email+"</td>",tableContent+='<td><a href="#" class="linkdeleteuser" rel="'+this._id+'">delete</a></td>',tableContent+="</tr>"}),$("#userList table tbody").html(tableContent)})}function showUserInfo(event){event.preventDefault();var thisUserName=$(this).attr("rel"),arrayPosition=userListData.map(function(arrayItem){return arrayItem.username}).indexOf(thisUserName),thisUserObject=userListData[arrayPosition];$("#userInfoName").text(thisUserObject.fullname),$("#userInfoAge").text(thisUserObject.age),$("#userInfoGender").text(thisUserObject.gender),$("#userInfoLocation").text(thisUserObject.location)}function addUser(event){event.preventDefault();var errorCount=0;if($("#addUser input").each(function(){""===$(this).val()&&errorCount++}),0!==errorCount)return alert("Please fill in all fields."),!1;var newUser={username:$("#addUser fieldset input#inputUserName").val(),email:$("#addUser fieldset input#inputUserEmail").val(),fullname:$("#addUser fieldset input#inputUserFullname").val(),age:$("#addUser fieldset input#inputUserAge").val(),location:$("#addUser fieldset input#inputUserLocation").val(),gender:$("#addUser fieldset input#inputUserGender").val()};$.ajax({type:"POST",data:newUser,url:"/users/adduser",dataType:"JSON"}).done(function(response){""===response.msg?($("#addUser fieldset input").val(""),populateTable()):alert("Error: "+response.msg)})}function deleteUser(event){event.preventDefault();var confirmation=confirm("Are you sure you want to delete this user?");return confirmation!==!0?!1:void $.ajax({type:"DELETE",url:"/users/deleteuser/"+$(this).attr("rel")}).done(function(response){""===response.msg||alert("Error: "+response.msg),populateTable()})}var userListData=[];$(document).ready(function(){populateTable(),$("#userList table tbody").on("click","td a.linkshowuser",showUserInfo),$("#btnAddUser").on("click",addUser),$("#userList table tbody").on("click","td a.linkdeleteuser",deleteUser)});